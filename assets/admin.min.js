var portfolio_slideshow=window.portfolio_slideshow||{};!function(o,t,i){var e;portfolio_slideshow={i18n:portfolio_slideshow_admin_i18n,order:"",el:{meta_box:t("#portfolio_slideshow_uploader_meta_box"),slides_list:""},reindex:function(){this.el.meta_box.find("li.portfolio-slideshow-draggable-item").each(function(o,i){t(i).find(".portfolio-slideshow-slide-footer .slide-index").text(o+1)})},update:function(){this.order=this.el.slides_list.sortable("toArray",{attribute:"data-attachment-id"}),this.reindex()},"delete":function(o){o.css("background","rgba(250, 0, 0, 0.55)").fadeOut(600,function(){o.remove(),portfolio_slideshow.update(),portfolio_slideshow.toggle_prompt()})},toggle_prompt:function(){portfolio_slideshow.el.slides_list.children(".portfolio-slideshow-draggable-item").length?this.el.meta_box.find(".portfolio-slideshow-no-slides-prompt").hide():this.el.meta_box.find(".portfolio-slideshow-no-slides-prompt").show()},setup_sortable:function(){this.el.slides_list.sortable({items:"> li.portfolio-slideshow-draggable-item",containment:this.el.meta_box,cursor:"move",opacity:.7,update:function(o,t){portfolio_slideshow.update()}})},init:function(){return this.el.meta_box.length?(this.el.slides_list=this.el.meta_box.find("ol.portfolio-slideshow-metabox-slides"),this.el.order_input=this.el.meta_box.find("#portfolio-slideshow-metabox-slides-order"),this.setup_sortable(),this.update(),this):void 0}}.init(),t(document).on("click","#portfolio-slideshow-add-slides .button-primary",function(o){return o.preventDefault(),i!==e?void e.open():(e=wp.media.frames.file_frame=wp.media({title:portfolio_slideshow.i18n.strings.add_plural,button:{text:portfolio_slideshow.i18n.strings.add_plural},multiple:!0}),e.on("select",function(){var o=e.state().get("selection");_.templateSettings.variable="portfolio_slideshow";var i=_.template(portfolio_slideshow.el.meta_box.find(t("script#portfolio-slideshow-add-slides-template")).html()),l={attachments:o.toJSON(),edit_text:portfolio_slideshow.i18n.strings.edit_singular,delete_text:portfolio_slideshow.i18n.strings.delete_singular};t.map(l.attachments,function(o,t){return o.alt=portfolio_slideshow.i18n.strings.slide_singular+" "+(t+1),o}),portfolio_slideshow.el.slides_list.append(i(l)),portfolio_slideshow.update(),portfolio_slideshow.toggle_prompt()}),void e.open())}),i!==portfolio_slideshow&&portfolio_slideshow.el.meta_box.length&&portfolio_slideshow.el.meta_box.on("click","a.portfolio-slideshow-quick-trash",function(o){o.preventDefault(),portfolio_slideshow["delete"](t(this).parents(".portfolio-slideshow-draggable-item").first())}),t(".portfolio-slideshow-tooltip").length&&t(".portfolio-slideshow-tooltip").tooltip({})}(window,jQuery);